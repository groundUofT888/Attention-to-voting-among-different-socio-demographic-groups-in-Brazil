---
title: "term papaer 2"
author: "Hao wang"
thanks: "Code and data are available at: https://github.com/groundUofT888/Term-Paper-2.git ; Replication on Social Science Reproduction platform available at: www.aeaweb.org/articles?id=10.1257/app.20210529"
date: "February 12, 2024"
date-format: long
format: 
  pdf: 
    include-in-header: 
      text: |
        \usepackage{lscape}
        \newcommand{\blandscape}{\begin{landscape}}
        \newcommand{\elandscape}{\end{landscape}}
    documentclass: article
    geometry: margin = 1in
    abstract: " "
    number-sections: true
output: 
  bookdown::pdf_document2
toc: false
fig_caption: yes 
nocite: '@*'
bibliography: references.bib
---

```{r setup}
#| echo: false
#| message: false
#| warning: false
# install.packages('readr')
install.packages("here")
install.packages("dplyr") 
install.packages("tidyr") 
install.packages("tidyverse")
installed.packages("ggplot2")
install.packages("kableExtra") 
# install.packages("knitr")


library(here)
library(dplyr)
library(tidyverse)
library(knitr)
library(rdrobust)
library(ggplot2)
library(tidyr) 
library(kableExtra) 

data_path <- here("outputs", "edited_data", "election_cleaned.csv")
election <- read.csv(data_path)
data_path2 <- here("outputs", "edited_data", "schools.csv") 
school <- read.csv(data_path2)
```

# Introduction

# Data

## Source

## Methodology

This paper will replicate the survey data that was originally collected for

## Features

The original survey data assessed participants on 60 variables

# Results

Data from Wave 4 of surveys were used to show correlation

\renewcommand{\arraystretch}{2}

```{r}
#| label: figl-terc
#| fig-cap: "Income per capita"
#| echo: false
#| message: false
#| warning: false

p <- ggplot(data = election, aes(x = tse_code, y = inc_post)) +
  geom_point(color = "blue") +  # Scatter plot points
  labs(x = "Number of registered voters", y = "Income per capita")
p + geom_smooth(method = "lm", color = "red")
```

```{r}
#| label: fig-excess
#| fig-cap: "Low income rate"
#| echo: false
#| message: false
#| warning: false

cutoff_value <-60000
election$cutoff_side <- ifelse(election$tse_code < cutoff_value, "Below", "Above")

p <- ggplot(data = election, aes(x = tse_code, y = inc_0_50_post)) +
  geom_point(color = "blue") +  # Scatter plot points
  labs(x = "Number of registered voters", y = "Low income rate") +
  geom_vline(xintercept = cutoff_value, linetype = "dashed", color = "black") + # Cutoff line
  geom_smooth(data = subset(election, tse_code < cutoff_value), 
              aes(x = tse_code, y = inc_0_50_post), 
              method = "lm", color = "red") + 
  geom_smooth(data = subset(election, tse_code >= cutoff_value), 
              aes(x = tse_code, y = inc_0_50_post), 
              method = "lm", color = "yellow") 
p 

```

```{r}
#| label: fig-ecoil
#| fig-cap: Unemployment rate
#| echo: false
#| message: false
#| warning: false

p <- ggplot(data = election, aes(x = tse_code, y = unempl_post)) +
  geom_point(color = "blue") +  # Scatter plot points
  labs(x = "Number of registered voters", y = "Unemployment rate")
p + geom_smooth(method = "lm", color = "red")
```

\clearpage

```{r}
#| label: fig-hist
#| fig-cap: histogram
#| echo: false
#| message: false
#| warning: false
data_long <- pivot_longer(election, cols = c("inc_0_50_post", "inc_post", "unempl_post"), 
                          names_to = "Variable", values_to = "Value")

ggplot(data_long, aes(x=Value, fill=Variable)) + 
  geom_histogram(position="dodge", binwidth=1) + 
  facet_wrap(~ Variable, scales = "free_x") + 
  theme_minimal() + 
  ggtitle("hist") +
  xlab("Value") +
  ylab("Frequency") +
  scale_fill_manual(values = c("inc_0_50_post" = "blue", "inc_post" = "red", "unempl_post" = "green"))
```

```{r}
#| label: fig-hist
#| tbl-cap: histogram
#| echo: false
#| message: false
#| warning: false

```

```{r}
#| label: fig-model
#| fig-cap: "umemployment rate Vs low income rate"
#| echo: false
#| message: false
#| warning: false

cutoff_value <-60000
school$cutoff_side <- ifelse(school$tse_code < cutoff_value, "Below", "Above")

p <- ggplot(data = school, aes(x = tse_code, y = MAT_DROP_mean)) +
  geom_point(color = "blue") +  
  labs(x = "Number of registered voters", y = "Drop-our rate") +
  geom_vline(xintercept = cutoff_value, linetype = "dashed", color = "black") + # Cutoff line
  geom_smooth(data = subset(election, tse_code < cutoff_value), 
              aes(x = tse_code, y = inc_0_50_post), 
              method = "lm", color = "red") + 
  geom_smooth(data = subset(election, tse_code >= cutoff_value), 
              aes(x = tse_code, y = inc_0_50_post), 
              method = "lm", color = "red") 
p 
```

\renewcommand{\arraystretch}{1.5}

\newpage

\blandscape

\elandscape

```{r, message=FALSE, message=FALSE, echo=FALSE, include=FALSE}
#| label: draft code (not used)

```

# Discussion

## Findings

## Canadian Relevance: Case Study on Alberta's

## population ratios, dating markets and anti-refugee sentiments

## Ethical Implications

## Accounting for Bias

## Limitations

## Future Research

\clearpage

# References {.unnumbered}
